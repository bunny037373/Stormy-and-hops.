<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fan Art Submissions Admin</title>
<style>
body { font-family: 'Comic Sans MS', sans-serif; padding: 20px; background: #fffbe6; }
h1 { color: #ff0000; }
.submission { border: 3px solid #ffd500; border-radius: 15px; padding: 15px; margin-bottom: 20px; background: white; }
img { max-width: 200px; display: block; margin-top: 10px; }
button { margin: 5px; padding: 8px 15px; border-radius: 10px; cursor: pointer; }
.approve { background: #28a745; color: white; border: none; }
.deny { background: #dc3545; color: white; border: none; }
</style>
</head>
<body>
<h1>Fan Art Submissions Admin</h1>
<div id="submissionsContainer"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-app.js";
import { getFirestore, collection, getDocs, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyCGIfsNq5MSv3tU46xjmDXKcsJM6LBXxUE",
  authDomain: "stormy-and-hops.firebaseapp.com",
  projectId: "stormy-and-hops",
  storageBucket: "stormy-and-hops.appspot.com",
  messagingSenderId: "227495295577",
  appId: "1:227495295577:web:4928330cefefba09a50f48"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const container = document.getElementById('submissionsContainer');

async function loadSubmissions() {
  container.innerHTML = "";
  const querySnapshot = await getDocs(collection(db, "fanArtSubmissions"));
  querySnapshot.forEach(docSnap => {
    const data = docSnap.data();
    const div = document.createElement('div');
    div.classList.add('submission');
    div.innerHTML = `
      <strong>Name:</strong> ${data.name}<br>
      <strong>Discord:</strong> ${data.discord}<br>
      <strong>Title:</strong> ${data.title}<br>
      <strong>Description:</strong> ${data.desc}<br>
      <img src="${data.fileUrl}" alt="Fan Art">
      <strong>Status:</strong> ${data.status}<br>
      <button class="approve">Approve</button>
      <button class="deny">Deny</button>
    `;
    const approveBtn = div.querySelector('.approve');
    const denyBtn = div.querySelector('.deny');

    approveBtn.onclick = async () => {
      await updateDoc(doc(db, "fanArtSubmissions", docSnap.id), { status: "Approved" });
      loadSubmissions();
    };

    denyBtn.onclick = async () => {
      const reason = prompt("Reason for denial:");
      if (reason !== null) {
        await updateDoc(doc(db, "fanArtSubmissions", docSnap.id), { status: "Denied", denialReason: reason });
        loadSubmissions();
      }
    };

    container.appendChild(div);
  });
}

loadSubmissions();
</script>
</body>
</html>
